# è¿œç¨‹æœåŠ¡å™¨å¿«é€Ÿä¿®å¤æ­¥éª¤

## ğŸš€ ä¸€é”®ä¿®å¤ï¼ˆæ¨èï¼‰

SSH è¿æ¥åˆ°æ‚¨çš„ Debian 12 æœåŠ¡å™¨åï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/tg2emall

# 2. æ‹‰å–æœ€æ–°ä¿®å¤ä»£ç 
git pull

# 3. è¿è¡Œä¿®å¤è„šæœ¬
chmod +x fix_tgstate_remote.sh
./fix_tgstate_remote.sh
```

**å°±è¿™ä¹ˆç®€å•ï¼** è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆæ‰€æœ‰ä¿®å¤æ­¥éª¤ã€‚

---

## ğŸ“‹ æ‰‹åŠ¨ä¿®å¤ï¼ˆå¦‚æœè„šæœ¬å¤±è´¥ï¼‰

```bash
# 1. è¿›å…¥é¡¹ç›®ç›®å½•
cd /path/to/tg2emall

# 2. åœæ­¢æ—§å®¹å™¨
docker-compose stop tgstate
docker-compose rm -f tgstate

# 3. é‡æ–°æ„å»ºï¼ˆåº”ç”¨ä¿®å¤ï¼‰
docker-compose build --no-cache tgstate

# 4. å¯åŠ¨æœåŠ¡
docker-compose up -d tgstate

# 5. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f tgstate
```

---

## âœ… éªŒè¯ä¿®å¤

```bash
# æµ‹è¯•ç®¡ç† API
curl http://localhost:8001/api/management/status

# é¢„æœŸè¿”å›ï¼š
# {"success":true,"data":{"status":"stopped",...}}
```

---

## ğŸ” æŸ¥çœ‹çŠ¶æ€

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose ps tgstate

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs -f tgstate

# ä»å‰ç«¯å®¹å™¨æµ‹è¯•è¿æ¥
docker exec -it tg2em-frontend curl http://tgstate:8001/api/management/status
```

---

## ğŸ“š è¯¦ç»†æ–‡æ¡£

- [å®Œæ•´ä¿®å¤æŒ‡å—](./REMOTE_FIX_GUIDE.md) - è¯¦ç»†çš„æ•…éšœæ’æŸ¥å’Œä¿®å¤æ­¥éª¤
- [æœåŠ¡å¯åŠ¨æŒ‡å—](./START_SERVICES.md) - æœåŠ¡å¯åŠ¨å’Œç®¡ç†

---

## â“ å¸¸è§é—®é¢˜

### ç«¯å£ 8001 è¢«å ç”¨ï¼Ÿ

```bash
# æŸ¥çœ‹å ç”¨è¿›ç¨‹
netstat -tlnp | grep 8001

# åœæ­¢å ç”¨è¿›ç¨‹æˆ–ä¿®æ”¹ docker-compose.yml ç«¯å£æ˜ å°„
ports:
  - "8003:8001"  # æ”¹ç”¨ 8003 ç«¯å£
```

### å®¹å™¨å¯åŠ¨åç«‹å³é€€å‡ºï¼Ÿ

```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose logs tgstate

# æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
cat .env
```

### Git æ‹‰å–æœ‰å†²çªï¼Ÿ

```bash
# æš‚å­˜æœ¬åœ°ä¿®æ”¹
git stash

# æ‹‰å–ä»£ç 
git pull

# æ¢å¤æœ¬åœ°ä¿®æ”¹ï¼ˆå¦‚æœéœ€è¦ï¼‰
git stash pop
```

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœä¿®å¤å¤±è´¥ï¼Œè¯·æ”¶é›†ä»¥ä¸‹ä¿¡æ¯ï¼š

```bash
# ç”Ÿæˆè¯Šæ–­æŠ¥å‘Š
{
  echo "=== ç³»ç»Ÿä¿¡æ¯ ==="
  uname -a
  echo ""
  echo "=== Docker ç‰ˆæœ¬ ==="
  docker --version
  docker-compose --version
  echo ""
  echo "=== å®¹å™¨çŠ¶æ€ ==="
  docker-compose ps
  echo ""
  echo "=== æœåŠ¡æ—¥å¿— ==="
  docker-compose logs --tail=50 tgstate
} > diagnostic_report.txt

# æŸ¥çœ‹æŠ¥å‘Š
cat diagnostic_report.txt
```

å°†è¯Šæ–­æŠ¥å‘Šå‘é€ç»™æŠ€æœ¯æ”¯æŒã€‚

