# ğŸ“± tg2emall - Telegram åˆ°è‡ªå®šä¹‰å‰ç«¯ä¸€ä½“åŒ–è§£å†³æ–¹æ¡ˆ

[![Docker](https://img.shields.io/badge/Docker-å…¼å®¹-2496ED?logo=docker)](https://www.docker.com/)
[![Python](https://img.shields.io/badge/Python-3.9+-3776AB?logo=python)](https://www.python.org/)
[![Go](https://img.shields.io/badge/Go-1.19+-00ADD8?logo=go)](https://golang.org/)
[![Flask](https://img.shields.io/badge/Flask-Latest-000000?logo=flask)](https://flask.palletsprojects.com/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

**tg2emall** æ˜¯ä¸€ä¸ªåŸºäº Docker çš„ä¸€ä½“åŒ–è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥è‡ªåŠ¨æŠ“å– Telegram é¢‘é“æ¶ˆæ¯ï¼Œé€šè¿‡ Web ç•Œé¢è¿›è¡Œç®¡ç†å±•ç¤ºï¼Œæ”¯æŒå›¾ç‰‡ä¸Šä¼ å’ŒæœåŠ¡é…ç½®ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ¯ **ä¸»è¦ç‰¹æ€§**
- ğŸ¤– **è‡ªåŠ¨åŒ–é‡‡é›†**: å®šæ—¶æŠ“å– Telegram é¢‘é“æ¶ˆæ¯
- ğŸŒ **Web ç®¡ç†ç•Œé¢**: å®Œæ•´çš„åå°ç®¡ç†ç³»ç»Ÿ
- ğŸ“· **å›¾ç‰‡ä¸Šä¼ **: æ”¯æŒ Telegram å›¾åºŠå’Œæœ¬åœ°å­˜å‚¨
- ğŸ”§ **é…ç½®ç®¡ç†**: Web ç•Œé¢ç®¡ç†æ‰€æœ‰é…ç½®å‚æ•°
- ğŸ–¥ï¸ **æœåŠ¡æ§åˆ¶**: ä¸€é”®å¯åŠ¨/åœæ­¢é‡‡é›†å’Œå›¾ç‰‡æœåŠ¡
- ğŸ“± **Telegram éªŒè¯**: Web ç•Œé¢è¾“å…¥éªŒè¯ç 
- ğŸ”„ **ä¼šè¯æŒä¹…åŒ–**: Telegram ä¼šè¯æ–‡ä»¶è‡ªåŠ¨ä¿å­˜
- ğŸ›¡ï¸ **å®‰å…¨ä¿æŠ¤**: å®Œå–„çš„èº«ä»½éªŒè¯å’Œæƒé™æ§åˆ¶

### ğŸ—ï¸ **æŠ€æœ¯æ¶æ„**
- **å‰ç«¯**: Flask + Bootstrap 5 + Jinja2
- **é‡‡é›†æœåŠ¡**: Python + Telethon + AsyncIO  
- **å›¾ç‰‡æœåŠ¡**: Go + Telegram Bot API
- **æ•°æ®åº“**: MySQL 8.0
- **éƒ¨ç½²**: Docker Compose + Profiles
- **åå‘ä»£ç†**: Nginx Proxy Manager

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ **ç³»ç»Ÿè¦æ±‚**
- Docker & Docker Compose
- 2GB+ å†…å­˜
- 10GB+ ç£ç›˜ç©ºé—´

### âš¡ **ä¸€é”®éƒ¨ç½²**
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/tg2emall.git
cd tg2emall

# é…ç½®ç¯å¢ƒå˜é‡
cp env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶é…ç½®å‚æ•°

# è¿è¡Œéƒ¨ç½²è„šæœ¬
chmod +x deploy.sh
./deploy.sh
```

### ğŸ”§ **æ‰‹åŠ¨éƒ¨ç½²**
```bash
# 1. å¯åŠ¨åŸºç¡€æœåŠ¡ï¼ˆMySQLã€å‰ç«¯ã€ä»£ç†ï¼‰
docker-compose up -d

# 2. ç­‰å¾… 30 ç§’è®©åŸºç¡€æœåŠ¡å¯åŠ¨
sleep 30

# 3. è®¿é—®ç®¡ç†åå°é…ç½®å‚æ•°
# http://your-server:5000/dm
# ç”¨æˆ·å: admin, å¯†ç : admin, éªŒè¯ç : 2025

# 4. å¯åŠ¨ä¸šåŠ¡æœåŠ¡ï¼ˆå¯é€‰ï¼‰
docker-compose --profile services up -d tgstate tg2em-scrape
```

## âš™ï¸ é…ç½®æŒ‡å—

### ğŸ” **ç®¡ç†åå°è®¿é—®**
- **è®¿é—®åœ°å€**: `http://your-server:5000/dm`
- **é»˜è®¤è´¦å·**: admin 
- **é»˜è®¤å¯†ç **: admin
- **éªŒè¯ç **: 2025 (å›ºå®šéªŒè¯ç )

### ğŸ“± **Telegram é…ç½®**
åœ¨ç®¡ç†åå°"é…ç½®ç®¡ç†"é¡µé¢é…ç½®ï¼š

```
telegram_api_id:      # ä» https://my.telegram.org è·å–
telegram_api_hash:    # ä» https://my.telegram.org è·å–
telegram_phone:       # Telegramç»‘å®šæ‰‹æœºå·ç ï¼ˆå¸¦å›½å®¶ä»£ç ï¼Œå¦‚ï¼š+8613800138000ï¼‰
telegram_session_name: tg2em_scraper (é»˜è®¤)
scrape_channels:      [{"url": "https://t.me/channel", "limit": 10}, {"id": -1001234567890, "limit": 15}]
scrape_limit:         10 (æ¯æ¬¡é‡‡é›†æ•°é‡)
scrape_interval:      300 (é‡‡é›†é—´éš”ç§’æ•°)
```

### ğŸ“· **å›¾ç‰‡æœåŠ¡é…ç½®ï¼ˆå¯é€‰ï¼‰**
å¦‚æœè¦ä½¿ç”¨ Telegram å›¾åºŠï¼š

```
tgstate_token:        # Telegram Bot Token
tgstate_target:       # ç›®æ ‡é¢‘é“ @channel_name
tgstate_pass:         none (è®¿é—®å¯†ç )
tgstate_mode:          p (APIæ¨¡å¼)
tgstate_url:          http://localhost:8088
```

### ğŸ—„ï¸ **æ•°æ®åº“é…ç½®**
```bash
MYSQL_ROOT_PASSWORD=tg2emall
MYSQL_DATABASE=tg2em
MYSQL_USER=tg2emall
MYSQL_PASSWORD=tg2emall
```

## ğŸ“± Telegram éªŒè¯æµç¨‹

### ğŸŒ **Web éªŒè¯æµç¨‹**
é¦–æ¬¡éƒ¨ç½²æˆ–é‡æ–°é…ç½®æ—¶ï¼ŒTelegram ä¼šè¦æ±‚æ‰‹æœºéªŒè¯ç ï¼š

1. **è‡ªåŠ¨æ£€æµ‹**: ç³»ç»Ÿæ£€æµ‹åˆ°éœ€è¦éªŒè¯ç æ—¶è‡ªåŠ¨æé†’
2. **è¿›å…¥éªŒè¯é¡µé¢**: ç®¡ç†åå° â†’ "TelegraméªŒè¯"
3. **è¾“å…¥éªŒè¯ç **: æ£€æŸ¥æ‰‹æœºçŸ­ä¿¡ï¼Œè¾“å…¥5ä½æ•°å­—éªŒè¯ç 
4. **è‡ªåŠ¨éªŒè¯**: ç³»ç»Ÿè‡ªåŠ¨å¤„ç†éªŒè¯è¿‡ç¨‹
5. **éªŒè¯å®Œæˆ**: æ˜¾ç¤ºç»¿è‰²æˆåŠŸçŠ¶æ€

### â° **éªŒè¯ç‰¹æ€§**
- ğŸŒ **å®Œå…¨ Web åŒ–**: æ— éœ€ SSH æˆ–å‘½ä»¤è¡Œæ“ä½œ
- âš¡ **å¿«é€ŸéªŒè¯**: 5ä½æ•°å­—è‡ªåŠ¨æäº¤
- ğŸ“± **ç§»åŠ¨å‹å¥½**: æ”¯æŒæ‰‹æœºå’Œå¹³æ¿æ“ä½œ
- ğŸ”” **æ™ºèƒ½æé†’**: è‡ªåŠ¨æ£€æµ‹å¹¶æç¤ºéªŒè¯éœ€æ±‚
- ğŸ›¡ï¸ **å®‰å…¨å¤„ç†**: éªŒè¯ç ä¸´æ—¶å­˜å‚¨ï¼Œå®Œæˆåç«‹å³æ¸…é™¤

## ğŸ–¥ï¸ ç®¡ç†åŠŸèƒ½

### ğŸ“Š **æ§åˆ¶å°**
- **ç»Ÿè®¡æ•°æ®**: æ€»æ–‡ç« æ•°ã€ä»Šæ—¥/æ˜¨æ—¥æ–°å¢ã€è®¿é—®IPç»Ÿè®¡
- **æœåŠ¡çŠ¶æ€**: å®æ—¶æ˜¾ç¤ºå„ä¸ªæœåŠ¡çš„è¿è¡ŒçŠ¶æ€
- **è®¿é—®æ¥æº**: æœç´¢å¼•æ“ã€ç›´æ¥è®¿é—®ã€ç¤¾äº¤åª’ä½“ç­‰ç»Ÿè®¡

### ğŸ“ **å†…å®¹ç®¡ç†**
- **æ–‡ç« åˆ—è¡¨**: åˆ†é¡µæ˜¾ç¤ºæ‰€æœ‰é‡‡é›†çš„æ–‡ç« 
- **ç¼–è¾‘æ–‡ç« **: ä¿®æ”¹æ ‡é¢˜å’Œå†…å®¹
- **åˆ é™¤æ–‡ç« **: å®‰å…¨åˆ é™¤ä¸éœ€è¦çš„æ–‡ç« 
- **æœç´¢åŠŸèƒ½**: æŒ‰æ ‡é¢˜æˆ–æ ‡ç­¾æœç´¢æ–‡ç« 

### âš™ï¸ **é…ç½®ç®¡ç†**
- **Telegram é…ç½®**: APIå‚æ•°ã€ä¼šè¯è®¾ç½®ã€é‡‡é›†å‚æ•°
- **å›¾ç‰‡æœåŠ¡é…ç½®**: tgState å›¾åºŠç›¸å…³å‚æ•°
- **æœåŠ¡æ§åˆ¶é…ç½®**: å„æœåŠ¡çš„å¯ç”¨çŠ¶æ€

### ğŸ”§ **æœåŠ¡ç®¡ç†**
- **æœåŠ¡çŠ¶æ€**: å®æ—¶ç›‘æ§æ‰€æœ‰æœåŠ¡è¿è¡ŒçŠ¶æ€
- **ä¸€é”®æ§åˆ¶**: å¯åŠ¨/åœæ­¢é‡‡é›†å’Œå›¾ç‰‡æœåŠ¡
- **æ‰¹é‡æ“ä½œ**: åŒæ—¶å¯åŠ¨æˆ–åœæ­¢æ‰€æœ‰ä¸šåŠ¡æœåŠ¡
- **çŠ¶æ€åˆ·æ–°**: è‡ªåŠ¨å’Œæ‰‹åŠ¨åˆ·æ–°æœåŠ¡çŠ¶æ€

## ğŸ› ï¸ æ•…éšœæ’é™¤

### âŒ **å¸¸è§é—®é¢˜**

#### **1. æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥**
**é”™è¯¯**: `ERROR 1054 (42S22): Unknown column 'description'`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ–¹æ¡ˆä¸€ï¼šæ¸…ç†é‡æ–°éƒ¨ç½²ï¼ˆæ¨èï¼‰
docker-compose down
docker volume rm tg2emall_mysql-data
docker-compose up -d

# æ–¹æ¡ˆäºŒï¼šæ‰‹åŠ¨ä¿®å¤ç°æœ‰æ•°æ®åº“
docker exec -it tg2em-mysql mysql -u root -ptg2emall tg2em
# åœ¨ MySQL ä¸­æ‰§è¡Œï¼š
ALTER TABLE messages ADD COLUMN source_channel varchar(100) DEFAULT NULL COMMENT 'æ¥æºé¢‘é“';
```

#### **2. æ¨¡æ¿è¯­æ³•é”™è¯¯**
**é”™è¯¯**: `Unknown tag 'cycle'`

**è§£å†³æ–¹æ¡ˆ**: å·²åœ¨æ–°ç‰ˆæœ¬ä¸­ä¿®å¤ï¼Œé‡æ–°éƒ¨ç½²å³å¯ã€‚

#### **3. Telegram éªŒè¯ç è¾“å…¥**
**ç°è±¡**: éœ€è¦åœ¨å®¹å™¨ä¸­è¾“å…¥éªŒè¯ç 

**è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨ç®¡ç†åå°çš„"TelegraméªŒè¯"åŠŸèƒ½ï¼š
1. è®¿é—®ç®¡ç†åå°éªŒè¯é¡µé¢
2. è¾“å…¥æ”¶åˆ°çš„5ä½æ•°å­—éªŒè¯ç 
3. ç³»ç»Ÿè‡ªåŠ¨å¤„ç†éªŒè¯

#### **4. å›¾ç‰‡ä¸Šä¼ å¤±è´¥**
**é”™è¯¯**: `Cannot connect to host tgstate:8088`

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ tgState æœåŠ¡æ˜¯å¦å¯åŠ¨ï¼š`docker-compose ps`
2. å¦‚æœæœªå¯åŠ¨ï¼Œåœ¨ç®¡ç†åå°"æœåŠ¡ç®¡ç†"é¡µé¢å¯åŠ¨
3. æˆ–é…ç½® tgState å‚æ•°åé‡å¯æœåŠ¡

#### **5. æœåŠ¡é»˜è®¤ä¸å¯åŠ¨**
**ç°è±¡**: éƒ¨ç½²ååªæœ‰åŸºç¡€æœåŠ¡è¿è¡Œ

**è¯´æ˜**: è¿™æ˜¯æ­£å¸¸çš„ï¼ä¸šåŠ¡æœåŠ¡ï¼ˆå›¾ç‰‡ã€é‡‡é›†ï¼‰éœ€è¦é…ç½®åå†å¯åŠ¨ï¼š
```bash
# æ–¹æ³•ä¸€ï¼šç®¡ç†åå°å¯åŠ¨
# è¿›å…¥"æœåŠ¡ç®¡ç†" â†’ ç‚¹å‡»"å¯åŠ¨"æŒ‰é’®

# æ–¹æ³•äºŒï¼šå‘½ä»¤è¡Œå¯åŠ¨
docker-compose --profile services up -d tgstate tg2em-scrape
```

### ğŸ” **æ£€æŸ¥å’Œè°ƒè¯•**

#### **æŸ¥çœ‹æœåŠ¡çŠ¶æ€**
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs frontend
docker-compose logs tg2em-scrape
docker-compose logs tgstate
```

#### **æ•°æ®åº“æ£€æŸ¥**
```bash
# è¿æ¥æ•°æ®åº“
docker exec -it tg2em-mysql mysql -u tg2emall -ptg2emall tg2em

# æ£€æŸ¥è¡¨ç»“æ„
DESCRIBE messages;
DESCRIBE system_config;
DESCRIBE services_status;

# æŸ¥çœ‹é…ç½®
SELECT * FROM system_config WHERE category = 'telegram';
```

#### **ç½‘ç»œè¿æ¥æ£€æŸ¥**
```bash
# æ£€æŸ¥å®¹å™¨ç½‘ç»œ
docker network ls | grep tg2em

# æµ‹è¯•å†…éƒ¨æœåŠ¡è¿æ¥
docker exec tg2em-scrape ping tgstate
docker exec tg2em-frontend ping mysql
```

## ğŸ“‚ **é¡¹ç›®ç»“æ„**

```
tg2emall/
â”œâ”€â”€ ğŸ“„ README.md                    # é¡¹ç›®è¯´æ˜ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”œâ”€â”€ ğŸ³ docker-compose.yml          # Docker ç¼–æ’é…ç½®
â”œâ”€â”€ ğŸ“œ deploy.sh                    # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ âš™ï¸ env.example                  # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ ğŸ—„ï¸ init.sql                    # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ ğŸ“ services/                    # æœåŠ¡ä»£ç 
â”‚   â”œâ”€â”€ ğŸ“ frontend/               # Flask å‰ç«¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ğŸ“œ app.py             # ä¸»åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ ğŸ“ templates/         # Jinja2 æ¨¡æ¿
â”‚   â”‚   â””â”€â”€ ğŸ“„ service_controller.py # æœåŠ¡æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ ğŸ“ tg2em/                 # Telegram é‡‡é›†æœåŠ¡
â”‚   â”‚   â””â”€â”€ ğŸ“œ scrape.py          # é‡‡é›†è„šæœ¬
â”‚   â””â”€â”€ ğŸ“ tgstate/               # Go å›¾ç‰‡æœåŠ¡
â”œâ”€â”€ ğŸ“ data/                       # æ•°æ®ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â”‚   â”œâ”€â”€ ğŸ“ mysql/                 # MySQL æ•°æ®
â”‚   â”œâ”€â”€ ğŸ“ telegram-sessions/      # Telegram ä¼šè¯
â”‚   â”œâ”€â”€ ğŸ“ logs/                  # æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ ğŸ“ upload/               # å›¾ç‰‡æ–‡ä»¶
â””â”€â”€ ğŸ“ init-npm.sql               # NPM åˆå§‹åŒ–è„šæœ¬
```

## ğŸ”„ **æ›´æ–°å’Œç»´æŠ¤**

### ğŸ“… **å®šæœŸç»´æŠ¤ä»»åŠ¡**
- ğŸ” **æ—¥å¿—æ¸…ç†**: å®šæœŸæ¸…ç†æ—¥å¿—æ–‡ä»¶
- ğŸ’¾ **æ•°æ®å¤‡ä»½**: å¤‡ä»½ MySQL æ•°æ®åº“
- ğŸ”„ **æœåŠ¡é‡å¯**: å®šæœŸé‡å¯æœåŠ¡ä»¥ç¡®ä¿ç¨³å®šè¿è¡Œ

### ğŸ”§ **æ‰‹åŠ¨æ¸…ç†**
```bash
# æ¸…ç†æ—¥å¿—
docker system prune -f

# æ¸…ç†æ—§é•œåƒ
docker image prune -f

# å¤‡ä»½æ•°æ®åº“
docker exec tg2em-mysql mysqldump -u root -ptg2emall tg2em > backup.sql
```

## ğŸ¤ **è´¡çŒ®æŒ‡å—**

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### ğŸ› **æŠ¥å‘Šé—®é¢˜**
è¯·æä¾›ï¼š
- æ“ä½œç³»ç»Ÿå’Œ Docker ç‰ˆæœ¬
- å®Œæ•´çš„é”™è¯¯æ—¥å¿—
- å¤ç°æ­¥éª¤

### ğŸ’» **å¼€å‘ç¯å¢ƒ**
```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/tg2emall.git

# å¼€å‘æ¨¡å¼è¿è¡Œ
docker-compose -f docker-compose.dev.yml up
```

## ğŸ“‹ **æ›´æ–°æ—¥å¿—**

### ğŸ†• v2.1 - é…ç½®ç®¡ç†å’ŒæœåŠ¡æ§åˆ¶
- âœ… Web ç•Œé¢é…ç½®ç®¡ç†
- âœ… æœåŠ¡å¯åŠ¨/åœæ­¢æ§åˆ¶
- âœ… Telegram éªŒè¯ç  Web è¾“å…¥
- âœ… Docker Profiles éƒ¨ç½²ä¼˜åŒ–
- âœ… æ•°æ®åº“å­—æ®µå’Œæ¨¡æ¿é”™è¯¯ä¿®å¤

### ğŸ†• v2.0 - ç®¡ç†åå°æ•´åˆ
- âœ… é›†æˆç®¡ç†åå°åˆ°å‰ç«¯æœåŠ¡
- âœ… ç®¡ç†å‘˜ç™»å½•éªŒè¯
- âœ… æ–‡ç« ç®¡ç†å’Œç¼–è¾‘åŠŸèƒ½
- âœ… ç»Ÿè®¡æ•°æ®å±•ç¤º

### ğŸ†• v1.0 - åŸºç¡€åŠŸèƒ½
- âœ… Telegram æ¶ˆæ¯é‡‡é›†
- âœ… Flask å‰ç«¯å±•ç¤º
- âœ… Docker ä¸€é”®éƒ¨ç½²
- âœ… å›¾ç‰‡ä¸Šä¼ æ”¯æŒ

## ğŸ“ **æ”¯æŒ**

- ğŸ“– **æ–‡æ¡£**: æœ¬é¡¹ç›®è¯´æ˜
- ğŸ› **é—®é¢˜**: [GitHub Issues](https://github.com/your-repo/tg2emall/issues)
- ğŸ’¬ **è®¨è®º**: [GitHub Discussions](https://github.com/your-repo/tg2emall/discussions)

## ğŸ“„ **è®¸å¯è¯**

æœ¬é¡¹ç›®åŸºäº [MIT License](LICENSE) å¼€æºã€‚

---

**ğŸ¯ tg2emall - è®© Telegram é‡‡é›†å’Œ Web ç®¡ç†å˜å¾—æ›´ç®€å•ï¼**

<div align="center">

**[ğŸ  é¦–é¡µ](http://your-server)** | **[ğŸ”§ ç®¡ç†åå°](http://your-server/dm)** | **[ğŸ“š æ–‡æ¡£](#-é…ç½®æŒ‡å—)** | **[ğŸ› æŠ¥å‘Šé—®é¢˜](https://github.com/your-repo/tg2emall/issues)**

</div>